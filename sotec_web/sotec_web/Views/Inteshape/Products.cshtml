@using System.Data
@using sotec_firma.Helpers
@using System.Configuration
@{
    ViewBag.Title = sotec_web.Resources.Dil.MAĞAZA;

    string lang = Request.Cookies.Get("MultiLanguageExample").Value;

    DataTable dt_dil = SQL.get("SELECT * FROM diller WHERE silindi = 0 AND kisa_kod = '" + lang + "'");
    if (dt_dil.Rows.Count <= 0) { dt_dil = SQL.get("SELECT * FROM diller WHERE silindi = 0 AND varsayilan = 1"); }
    DataRow dr_dil = dt_dil.Rows[0];

    int sayfa_no = ViewBag.sayfa_no;
    int kategori_id = ViewBag.kategori_id;

    int cnt_urun = Convert.ToInt32(SQL.get("SELECT cnt = COUNT(*) FROM bloglar b WHERE b.silindi = 0 " + (kategori_id == 0 ? "" : " AND b.kategori_id = " + kategori_id + " ")).Rows[0]["cnt"]);
    int sayfa_sayisi = Convert.ToInt32(Math.Ceiling(Convert.ToDecimal(cnt_urun) / 10));

    DataTable dt_urunler = SQL.get("SELECT b.urun_id, b.fiyat, b.stok_kodu, urun_adi = ISNULL(db.urun_adi, b.urun_adi), aciklama = ISNULL(db.aciklama, b.aciklama), b.kayit_tarihi, resim = ISNULL((SELECT TOP 1 resim FROM urun_resimleri WHERE silindi = 0 AND urun_id = b.urun_id AND sira = (SELECT MIN(sira) FROM urun_resimleri WHERE silindi = 0 AND urun_id = b.urun_id)), '') FROM urunler b INNER JOIN kullanicilar k ON k.kullanici_id = b.kaydeden_kullanici_id LEFT OUTER JOIN dil_urunler db ON db.urun_id = b.urun_id AND db.silindi = 0 AND db.dil_id = " + dr_dil["dil_id"] + " WHERE b.silindi = 0 " + (kategori_id == 0 ? "" : " AND " + kategori_id + " IN (SELECT kategori_id FROM urun_kategorileri WHERE silindi = 0 AND urun_id = b.urun_id) ") + " ORDER by b.urun_id DESC OFFSET " + (sayfa_no * 10) + " ROWS FETCH NEXT 10 ROWS ONLY");
    DataTable dt_urun_kategori = SQL.get("SELECT k.kategori_id, kategori = ISNULL(dk.kategori, k.kategori) FROM kategoriler k LEFT OUTER JOIN dil_kategoriler dk ON dk.kategori_id = k.kategori_id AND dk.silindi = 0 AND dk.dil_id = " + dr_dil["dil_id"] + " WHERE k.silindi = 0 AND k.ust_kategori_id = 0 AND k.kategori_tipi_parametre_id = 16");
}
<div class="sx-bnr-inr overlay-wraper bg-parallax bg-top-center" data-stellar-background-ratio="0.5" style="background-image:url(images/banner/7.jpg);">
    <div class="overlay-main bg-black opacity-07"></div>
    <div class="container">
        <div class="sx-bnr-inr-entry">
            <div class="banner-title-outer">
                <div class="banner-title-name">
                    <h2 class="m-tb0">@sotec_web.Resources.Dil.ÜRÜNLERİMİZ</h2>
                </div>
            </div>
            <div>
                <ul class="sx-breadcrumb breadcrumb-style-2">
                    <li><a href="@Url.Action("Index", "Inteshape")">@sotec_web.Resources.Dil.ANA_SAYFA</a></li>
                    <li>@sotec_web.Resources.Dil.ÜRÜNLERİMİZ</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="section-full p-tb80 bg-white inner-page-padding">
    <div class="container">
        <div class="masonry-outer mfp-gallery news-grid clearfix row ">
            @foreach (DataRow dr_urun_item in dt_urunler.Rows)
            {
                <div class="masonry-item  col-lg-4 col-md-6 col-sm-12">
                    <div class="blog-post blog-grid date-style-2">
                        <div class="sx-post-media sx-img-effect img-reflection">
                            <a href="@Url.Action("Product", "Inteshape", new { id = dr_urun_item["urun_id"] })"><img src="~/admin_src/images/urun/kucuk/@dr_urun_item["resim"]" alt=""></a>
                        </div>
                        <div class="sx-post-info p-t30">
                            <div class="sx-post-meta ">
                                <ul>
                                    <li class="post-date">@dr_urun_item["stok_kodu"]</li>
                                </ul>
                            </div>
                            <div class="sx-post-title ">
                                <h4 class="post-title"><a href="@Url.Action("Product", "Inteshape", new { id = dr_urun_item["urun_id"] })">@dr_urun_item["urun_adi"]</a></h4>
                            </div>
                            <div class="sx-post-readmore">
                                <a href="@Url.Action("Product", "Inteshape", new { id = dr_urun_item["urun_id"] })" title="@sotec_web.Resources.Dil.DEVAMINI_OKU" rel="bookmark" class="site-button-link">@sotec_web.Resources.Dil.DEVAMINI_OKU</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        <ul class="pagination m-t30 m-b0">
            @for (int i = 0; i < sayfa_sayisi; i++)
            {
                <li class="@(i == sayfa_no ? "active" : "")"><a href="@Url.Action("Products", new { id = i, id2 = kategori_id })">@(i + 1)</a></li>
            }
        </ul>
    </div>
</div>