@using System.Data
@using sotec_firma.Helpers
@using System.Configuration
@{
    ViewBag.Title = sotec_web.Resources.Dil.MAĞAZA;

    string lang = Request.Cookies.Get("MultiLanguageExample").Value;

    DataTable dt_dil = SQL.get("SELECT * FROM diller WHERE silindi = 0 AND kisa_kod = '" + lang + "'");
    if (dt_dil.Rows.Count <= 0) { dt_dil = SQL.get("SELECT * FROM diller WHERE silindi = 0 AND varsayilan = 1"); }
    DataRow dr_dil = dt_dil.Rows[0];

    int sayfa_no = ViewBag.sayfa_no;
    int kategori_id = ViewBag.kategori_id;

    int cnt_urun = Convert.ToInt32(SQL.get("SELECT cnt = COUNT(*) FROM bloglar b WHERE b.silindi = 0 " + (kategori_id == 0 ? "" : " AND b.kategori_id = " + kategori_id + " ")).Rows[0]["cnt"]);
    int sayfa_sayisi = Convert.ToInt32(Math.Ceiling(Convert.ToDecimal(cnt_urun) / 10));

    DataTable dt_urunler = SQL.get("SELECT b.urun_id, b.fiyat, urun_adi = ISNULL(db.urun_adi, b.urun_adi), aciklama = ISNULL(db.aciklama, b.aciklama), b.kayit_tarihi, resim = ISNULL((SELECT TOP 1 resim FROM urun_resimleri WHERE silindi = 0 AND urun_id = b.urun_id AND sira = (SELECT MIN(sira) FROM urun_resimleri WHERE silindi = 0 AND urun_id = b.urun_id)), '') FROM urunler b INNER JOIN kullanicilar k ON k.kullanici_id = b.kaydeden_kullanici_id LEFT OUTER JOIN dil_urunler db ON db.urun_id = b.urun_id AND db.silindi = 0 AND db.dil_id = " + dr_dil["dil_id"] + " WHERE b.silindi = 0 " + (kategori_id == 0 ? "" : " AND " + kategori_id + " IN (SELECT kategori_id FROM urun_kategorileri WHERE silindi = 0 AND urun_id = b.urun_id) ") + " ORDER by b.urun_id DESC OFFSET " + (sayfa_no * 10) + " ROWS FETCH NEXT 10 ROWS ONLY");
    DataTable dt_urun_kategori = SQL.get("SELECT k.kategori_id, kategori = ISNULL(dk.kategori, k.kategori) FROM kategoriler k LEFT OUTER JOIN dil_kategoriler dk ON dk.kategori_id = k.kategori_id AND dk.silindi = 0 AND dk.dil_id = " + dr_dil["dil_id"] + " WHERE k.silindi = 0 AND k.ust_kategori_id = 0 AND k.kategori_tipi_parametre_id = 16");
}
<div class="container-indent">
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-lg-3 col-xl-3 leftColumn aside">
                <div class="tt-collapse open">
                    <h3 class="tt-collapse-title">@sotec_web.Resources.Dil.KATEGORİLER</h3>
                    <div class="tt-collapse-content">
                        <ul class="tt-list-row">
                            @foreach (DataRow dr_kategori_item in dt_urun_kategori.Rows)
                            {
                                <li class="@(kategori_id.ToString() == dr_kategori_item["kategori_id"].ToString() ? "active" : "")"><a href="@Url.Action("Products", "Home", new { id = 0, id2 = dr_kategori_item["kategori_id"] })">@dr_kategori_item["kategori"]</a></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-12 col-lg-9 col-xl-9">
                <div class="content-indent container-fluid-custom-mobile-padding-02">
                    <div class="tt-filters-options">
                        <h1 class="tt-title">
                            @sotec_web.Resources.Dil.MAĞAZA
                        </h1>
                        <div class="tt-btn-toggle">
                            <a href="#">FILTER</a>
                        </div>
                        <!--<div class="tt-sort">
                            <select>
                                <option value="Default Sorting">Default Sorting</option>
                                <option value="Default Sorting">Default Sorting 02</option>
                                <option value="Default Sorting">Default Sorting 03</option>
                            </select>
                            <select>
                                <option value="Show">Show</option>
                                <option value="9">9</option>
                                <option value="16">16</option>
                                <option value="32">32</option>
                            </select>
                        </div>-->
                        <div class="tt-quantity">
                            <a href="#" class="tt-col-one" data-value="tt-col-one"></a>
                            <a href="#" class="tt-col-two" data-value="tt-col-two"></a>
                            <a href="#" class="tt-col-three" data-value="tt-col-three"></a>
                            <a href="#" class="tt-col-four" data-value="tt-col-four"></a>
                            <a href="#" class="tt-col-six" data-value="tt-col-six"></a>
                        </div>
                    </div>
                    <div class="tt-product-listing row">
                        @foreach (DataRow dr_urun_item in dt_urunler.Rows)
                        {
                            <div class="col-6 col-md-4 tt-col-item">
                                <div class="tt-product thumbprod-center">
                                    <div class="tt-image-box">
                                        <!--<a href="#" class="tt-btn-quickview" data-toggle="modal" data-target="#ModalquickView" data-tooltip="Quick View" data-tposition="left"></a>
                                        <a href="#" class="tt-btn-wishlist" data-tooltip="Add to Wishlist" data-tposition="left"></a>
                                        <a href="#" class="tt-btn-compare" data-tooltip="Add to Compare" data-tposition="left"></a>-->
                                        <a href="@Url.Action("Product", "Home", new { id = dr_urun_item["urun_id"] })">
                                            <span class="tt-img"><img src="~/wokiee_src/images/loader.svg" data-src="/admin_src/images/urun/kucuk/@dr_urun_item["resim"]" alt=""></span>
                                            <span class="tt-img-roll-over"><img src="~/wokiee_src/images/loader.svg" data-src="/admin_src/images/urun/kucuk/@dr_urun_item["resim"]" alt=""></span>
                                        </a>
                                    </div>
                                    <div class="tt-description">
                                        <div class="tt-row">
                                            <ul class="tt-add-info">
                                                <!--<li><a href="#">VENDER</a></li>-->
                                            </ul>
                                        </div>
                                        <h2 class="tt-title"><a href="@Url.Action("Product", "Home", new { id = dr_urun_item["urun_id"] })">@dr_urun_item["urun_adi"]</a></h2>
                                        <div class="tt-price">
                                            @if (ConfigurationManager.AppSettings["eticaret"] == "true")
                                            {@dr_urun_item["fiyat"] }
                                        else
                                        { <br />}
                                        </div>
                                        <div class="tt-product-inside-hover">
                                            <div class="tt-row-btn">
                                                <!--<a href="#" class="tt-btn-addtocart thumbprod-button-bg" data-toggle="modal" data-target="#modalAddToCartProduct">ADD TO CART</a>-->
                                            </div>
                                            <div class="tt-row-btn">
                                                <!--<a href="#" class="tt-btn-quickview" data-toggle="modal" data-target="#ModalquickView"></a>
                                                <a href="#" class="tt-btn-wishlist"></a>
                                                <a href="#" class="tt-btn-compare"></a>-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="tt-pagination">
                        <ul>
                            @for (int i = 0; i < sayfa_sayisi; i++)
                            {
                                <li class="@(i == sayfa_no ? "active" : "")"><a href="@Url.Action("Products", new { id = i, id2 = kategori_id })">@(i + 1)</a></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>